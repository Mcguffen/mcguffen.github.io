<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Webpack核心使用WebpackPlugin::: tip 理解plugin的理解是：当 Webpack 运行到某一个阶段时，可以使用plugin来帮我们做一些事情。:::在使用plugin之前，我们先来改造一下我们的代码，首先删掉无用的文件，随后在根目录下新建一个src文件夹，并把index.js移动到src文件夹下，移动后你的目录看起来应该是下面这样子的 1234567|-- dist|">
<meta property="og:type" content="article">
<meta property="og:title" content="Webpack核心">
<meta property="og:url" content="https://mcguffen.github/2020/11/20/docs/webpack/core/index.html">
<meta property="og:site_name" content="Hi! I am yang.">
<meta property="og:description" content="Webpack核心使用WebpackPlugin::: tip 理解plugin的理解是：当 Webpack 运行到某一个阶段时，可以使用plugin来帮我们做一些事情。:::在使用plugin之前，我们先来改造一下我们的代码，首先删掉无用的文件，随后在根目录下新建一个src文件夹，并把index.js移动到src文件夹下，移动后你的目录看起来应该是下面这样子的 1234567|-- dist|">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-11-20T00:00:00.000Z">
<meta property="article:modified_time" content="2021-04-13T10:10:12.869Z">
<meta property="article:tag" content="webpack">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Webpack核心</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/Mcguffen?tab=repositories">项目</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/11/22/docs/webpack/case/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2020/11/19/docs/webpack/install/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://mcguffen.github/2020/11/20/docs/webpack/core/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&text=Webpack核心"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&is_video=false&description=Webpack核心"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Webpack核心&body=Check out this article: https://mcguffen.github/2020/11/20/docs/webpack/core/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&name=Webpack核心&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://mcguffen.github/2020/11/20/docs/webpack/core/&t=Webpack核心"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Webpack%E6%A0%B8%E5%BF%83"><span class="toc-number">1.</span> <span class="toc-text">Webpack核心</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8WebpackPlugin"><span class="toc-number">1.1.</span> <span class="toc-text">使用WebpackPlugin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#html-webpack-plugin"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">html-webpack-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#clean-webpack-plugin"><span class="toc-number">1.1.0.2.</span> <span class="toc-text">clean-webpack-plugin</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Entry%E5%92%8COutput%E7%9A%84%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">Entry和Output的基础配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.1.</span> <span class="toc-text">多个入口文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CDN%E5%BC%95%E7%94%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text">CDN引用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AESourceMap"><span class="toc-number">1.3.</span> <span class="toc-text">配置SourceMap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8WebpackDevServer"><span class="toc-number">1.4.</span> <span class="toc-text">使用WebpackDevServer</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#watch%E5%8F%82%E6%95%B0%E8%87%AA%E5%8A%A8%E6%89%93%E5%8C%85"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">watch参数自动打包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack-dev-server%E6%89%93%E5%8C%85"><span class="toc-number">1.4.0.2.</span> <span class="toc-text">webpack-dev-server打包</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%B4%E6%96%B0-HMR"><span class="toc-number">1.5.</span> <span class="toc-text">模块热更新(HMR)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CSS%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%B4%E6%96%B0"><span class="toc-number">1.5.0.1.</span> <span class="toc-text">CSS中的模块热更新</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8js%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%B4%E6%96%B0"><span class="toc-number">1.5.0.2.</span> <span class="toc-text">在js中的模块热更新</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86ES6%E8%AF%AD%E6%B3%95"><span class="toc-number">1.6.</span> <span class="toc-text">处理ES6语法</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Webpack核心
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name"></span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-11-20T00:00:00.000Z" itemprop="datePublished">2020-11-20</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/frontEnd/">frontEnd</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/webpack/" rel="tag">webpack</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Webpack核心"><a href="#Webpack核心" class="headerlink" title="Webpack核心"></a>Webpack核心</h1><h2 id="使用WebpackPlugin"><a href="#使用WebpackPlugin" class="headerlink" title="使用WebpackPlugin"></a>使用WebpackPlugin</h2><p>::: tip 理解<br><code>plugin</code>的理解是：当 Webpack 运行到某一个阶段时，可以使用<code>plugin</code>来帮我们做一些事情。<br>:::<br>在使用<code>plugin</code>之前，我们先来改造一下我们的代码，首先删掉无用的文件，随后在根目录下新建一个<code>src</code>文件夹，并把<code>index.js</code>移动到<code>src</code>文件夹下，移动后你的目录看起来应该是下面这样子的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|-- dist</span><br><span class="line">|   |-- index.html</span><br><span class="line">|-- src</span><br><span class="line">|   |-- index.js</span><br><span class="line">|-- postcss.config.js</span><br><span class="line">|-- webpack.config.js</span><br><span class="line">|-- package.json</span><br></pre></td></tr></table></figure>
<p>接下来再来处理一下<code>index.js</code>文件的代码，写成下面这样</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">var</span> root = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> dom = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">dom.innerHTML = <span class="string">&#x27;hello,world&#x27;</span>;</span><br><span class="line">root.appendChild(dom);</span><br></pre></td></tr></table></figure>
<p>最后我们来处理一下我们的<code>webpack.config.js</code>文件，它的改动有下面这些</p>
<ul>
<li>因为<code>index.js</code>文件的位置变动了，我们需要改动一下<code>entry</code></li>
<li>删除掉我们配置的所有<code>loader</code>规则<br>按照上面的改动后，<code>webpack.config.js</code>中的代码看起来是下面这样的<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    main: <span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&#x27;main.js&#x27;</span>,</span><br><span class="line">    path: path.resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="html-webpack-plugin"><a href="#html-webpack-plugin" class="headerlink" title="html-webpack-plugin"></a>html-webpack-plugin</h4>::: tip 说明<br><code>html-webpack-plugin</code>可以让我们使用固定的模板，在每次打包的时候 <strong>自动生成</strong> 一个<code>index.html</code>文件，并且它会 <strong>自动</strong> 帮我们引入我们打包后的<code>.js</code>文件<br>:::<br>使用如下命令安装<code>html-webpack-plugin</code><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install html-webpack-plugin -D</span><br></pre></td></tr></table></figure></li>
</ul>
<p>在<code>src</code>目录下创建<code>index.html</code>模板文件，它的代码可以写成下面这样子</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Html 模板<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>因为我们要使用<code>html-webpack-plugin</code>插件，所以我们需要再次改写<code>webpack.config.js</code>文件(具体改动部分见高亮部分)</p>
<figure class="highlight js"><figcaption><span>&#123;2,8,9,10,11,12&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    main: <span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: <span class="string">&#x27;src/index.html&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&#x27;main.js&#x27;</span>,</span><br><span class="line">    path: path.resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在完成上面的配置后，我们使用<code>npm run bundle</code>命令来打包一下测试一下，在打包完毕后，我们能在<code>dist</code>目录下面，看到<code>index.html</code>中的代码变成下面这样子</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML模板<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;main.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们发现，以上<code>index.html</code>的结构，正是我们在<code>src</code>目录下<code>index.html</code>模板的结构，并且还能发现，在打包完成后，还自动帮我们引入了打包输出的<code>.js</code>文件，这正是<code>html-webpack-plugin</code>的基本功能，当然它还有其它更多的功能，我们将在后面进行详细的说明。</p>
<h4 id="clean-webpack-plugin"><a href="#clean-webpack-plugin" class="headerlink" title="clean-webpack-plugin"></a>clean-webpack-plugin</h4><p>::: tip 理解<br><code>clean-webpack-plugin</code>的理解是：它能帮我们在打包之前 <strong>自动删除</strong> <code>dist</code>打包目录及其目录下所有文件，不用我们手动进行删除。<br>:::</p>
<p>我们使用如下命令来安装<code>clean-webpack-plugin</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install clean-webpack-plugin -D</span><br></pre></td></tr></table></figure>
<p>安装完毕以后，我们同样需要在<code>webpack.config.js</code>中进行配置(改动部分参考高亮代码块)</p>
<figure class="highlight js"><figcaption><span>&#123;3,13&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">&#x27;clean-webpack-plugin&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    main: <span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: <span class="string">&#x27;src/index.html&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin()</span><br><span class="line">  ],</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&#x27;main.js&#x27;</span>,</span><br><span class="line">    path: path.resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在完成以上配置后，我们使用<code>npm run bundle</code>打包命令进行打包，它的打包结果请自行在你的项目下观看自动清理<code>dist</code>目录的实时效果。<br></p>
<p>在使用<code>WebpackPlugin</code>小节，我们只介绍了两种常用的<code>plugin</code>，更多<code>plugin</code>的用法我们将在后续进行学习，你也可以点击<a target="_blank" rel="noopener" href="https://webpack.js.org/plugins">Webpack Plugins</a>来学习更多官网推荐的<code>plugin</code>用法。</p>
<h2 id="Entry和Output的基础配置"><a href="#Entry和Output的基础配置" class="headerlink" title="Entry和Output的基础配置"></a>Entry和Output的基础配置</h2><h3 id="多个入口文件"><a href="#多个入口文件" class="headerlink" title="多个入口文件"></a>多个入口文件</h3><p>在我们之前的所有<code>entry</code>配置中，仅仅只有一个入口文件，假设现在我们有这样一个需求：需要把<code>index.js</code>打包两遍，一个叫<code>main.js</code>，另外一个叫<code>sub.js</code>，那么我们应该在<code>entry</code>进行如下的配置：</p>
<figure class="highlight js"><figcaption><span>&#123;6&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    main: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    sub: <span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">&#x27;main.js&#x27;</span>,</span><br><span class="line">    path: path.resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：如果我们仅仅只是调整了<code>entry</code>配置，没有进行<code>output</code>配置修改的话，则会打包错误。原因是<code>output</code>打包后的文件都叫<code>main.js</code>，但我们<code>entry</code>却有两个入口文件，因此会造成错误，所以我们同样需要对<code>output</code>配置进行修改：</p>
<figure class="highlight js"><figcaption><span>&#123;10&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    main: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    sub: <span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// 使用[name]占位符，打包结果为main.js，sub.js</span></span><br><span class="line">    filename: <span class="string">&#x27;[name].js&#x27;</span>,</span><br><span class="line">    path: path.resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>进行如上配置后，<code>dist/index.html</code>文件中<code>js</code>的引用如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;main.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;sub.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="CDN引用"><a href="#CDN引用" class="headerlink" title="CDN引用"></a>CDN引用</h3><p>在打包后，把静态资源发布到<code>CDN</code>是一种常见的提高网页性能的手段，正如你在上面所看到的的那样，我们现在的打包方式并不能实现<code>CDN</code>引用，需要我们进行如下的配置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    main: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    sub: <span class="string">&#x27;./src/index.js&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// 假设一个CDN地址</span></span><br><span class="line">    publicPath: <span class="string">&#x27;www.cdn.com/wangtunan&#x27;</span>,</span><br><span class="line">    <span class="comment">// 使用[name]占位符，打包结果为main.js，sub.js</span></span><br><span class="line">    filename: <span class="string">&#x27;[name].js&#x27;</span>,</span><br><span class="line">    path: path.resolve(__dirname,<span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面的配置完毕，我们打包后<code>dist/index.html</code>的<code>js</code>引用效果如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;www.cdn.com/wangtunan/main.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;www.cdn.com/wangtunan/sub.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="配置SourceMap"><a href="#配置SourceMap" class="headerlink" title="配置SourceMap"></a>配置SourceMap</h2><p>::: tip 理解<br><code>source-map</code>的理解：它是一种映射关系，它映射了打包后的代码和源代码之间的对应关系，一般通过<code>devtool</code>来配置。<br>:::</p>
<p>以下是官方提供的<code>devtool</code>各个属性的解释以及打包速度对比图：</p>
<p>通过上图我们可以看出，良好的<code>source-map</code>配置不仅能帮助我们提高打包速度，同时在代码维护和调错方面也能有很大的帮助，一般来说，<code>source-map</code>的最佳实践是下面这样的：</p>
<ul>
<li>开发环境下<code>development</code>：推荐将<code>devtool</code>设置成<code>cheap-module-eval-source-map</code></li>
<li>生产环境下<code>production</code>：推荐将<code>devtool</code>设置成<code>cheap-module-source-map</code></li>
</ul>
<h2 id="使用WebpackDevServer"><a href="#使用WebpackDevServer" class="headerlink" title="使用WebpackDevServer"></a>使用WebpackDevServer</h2><p>::: tip 理解<br><code>webpack-dev-server</code>的理解：它能帮助我们在源代码更改的情况下，<strong>自动</strong> 帮我们打包我们的代码并 <strong>启动</strong> 一个小型的服务器。如果与热更新一起使用，它能帮助我们高效的开发。<br>:::</p>
<p>自动打包的方案，通常来说有如下几种：</p>
<ul>
<li><code>watch</code>参数自动打包：它是在打包命令后面跟了一个<code>--watch</code>参数，它虽然能帮我们自动打包，但我们任然需要手动刷新浏览器，同时它不能帮我们在本地启动一个小型服务器，一些<code>http</code>请求不能通过。</li>
<li><code>webpack-dev-server</code>插件打包(推荐)：它是我们推荐的一种自动打包方案，在开发环境下使用尤其能帮我们高效的开发，它能解决<code>watch</code>参数打包中的问题，如果我们与热更新<code>HMR</code>一起使用，我们将拥有非常良好的开发体验。</li>
</ul>
<h4 id="watch参数自动打包"><a href="#watch参数自动打包" class="headerlink" title="watch参数自动打包"></a>watch参数自动打包</h4><p>使用<code>watch</code>参数进行打包，我们需要在<code>package.json</code>中新增一个<code>watch</code>打包命令，它的配置如下</p>
<figure class="highlight json"><figcaption><span>&#123;5&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 其它配置</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bundle&quot;</span>: <span class="string">&quot;webpack&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;watch&quot;</span>: <span class="string">&quot;webpack --watch&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在配置好上面的打包命令后，我们使用<code>npm run watch</code>命令进行打包，然后在浏览器中运行<code>dist</code>目录下的<code>index.html</code>，运行后，我们尝试修改<code>src/index.js</code>中的代码，例如把<code>hello,world</code>改成<code>hello,dell-lee</code>，改动完毕后，我们刷新一下浏览器，会发现浏览器成功输出<code>hello,dell-lee</code>，这也证明了<code>watch</code>参数确实能自动帮我们进行打包。</p>
<h4 id="webpack-dev-server打包"><a href="#webpack-dev-server打包" class="headerlink" title="webpack-dev-server打包"></a>webpack-dev-server打包</h4><p>要使用<code>webpack-dev-server</code>，我们需要使用如下命令进行安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install webpack-dev-server -D</span><br></pre></td></tr></table></figure>
<p>安装完毕后，我们和<code>watch</code>参数配置打包命令一样，也需要新增一个打包命令，在<code>package.json</code>中做如下改动：</p>
<figure class="highlight"><figcaption><span>&#123;5&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 其它配置</span></span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;bundle&quot;: &quot;webpack&quot;,</span><br><span class="line">    &quot;watch&quot;: &quot;webpack --watch&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;webpack-dev-server&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>配置完打包命令后，我们最后需要对<code>webpack.config.js</code>做一下处理：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 其它配置</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    <span class="comment">// 以dist为基础启动一个服务器，服务器运行在4200端口上，每次启动时自动打开浏览器</span></span><br><span class="line">    contentBase: <span class="string">&#x27;dist&#x27;</span>,</span><br><span class="line">    open: <span class="literal">true</span>,</span><br><span class="line">    port: <span class="number">4200</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在以上都配置完毕后，我们使用<code>npm run dev</code>命令进行打包，它会自动帮我们打开浏览器，现在你可以在<code>src/index.js</code>修改代码，再在浏览器中查看效果，它会有惊喜的哦，ღ( ´･ᴗ･` )比心<br></p>
<p>这一小节主要介绍了如何让工具自动帮我们打包，下一节我们将学习模块热更新(HMR)。</p>
<h2 id="模块热更新-HMR"><a href="#模块热更新-HMR" class="headerlink" title="模块热更新(HMR)"></a>模块热更新(HMR)</h2><p>::: tip 理解<br>模块热更新(HMR)的理解：它能够让我们在不刷新浏览器(或自动刷新)的前提下，在运行时帮我们更新最新的代码。<br>:::<br>模块热更新(HMR)已内置到 Webpack ,我们只需要在<code>webpack.config.js</code>中像下面这样简单的配置即可，无需安装别的东西。</p>
<figure class="highlight js"><figcaption><span>&#123;1,8,9,13&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 其它配置</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: <span class="string">&#x27;dist&#x27;</span>,</span><br><span class="line">    open: <span class="literal">true</span>,</span><br><span class="line">    port: <span class="number">3000</span>,</span><br><span class="line">    hot: <span class="literal">true</span>,    <span class="comment">// 启用模块热更新</span></span><br><span class="line">    hotOnly: <span class="literal">true</span> <span class="comment">// 模块热更新启动失败时，不重新刷新浏览器</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// 其它插件</span></span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在模块热更新(HMR)配置完毕后，我们现在来想一下，什么样的代码是我们希望能够热更新的，我们发现大多数情况下，我们似乎只需要关心两部分内容：<code>CSS</code>文件和<code>.js</code>文件，根据这两部分，我们将分别来进行介绍。</p>
<h4 id="CSS中的模块热更新"><a href="#CSS中的模块热更新" class="headerlink" title="CSS中的模块热更新"></a>CSS中的模块热更新</h4><p>首先我们在<code>src</code>目录下新建一个<code>style.css</code>样式文件，它的代码可以这样下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-pseudo">:nth-of-type</span>(odd) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>随后我们改写一下<code>src</code>目录下的<code>index.js</code>中的代码，像下面这样子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.createElement(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">btn.innerHTML = <span class="string">&#x27;新增&#x27;</span>;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(btn);</span><br><span class="line"></span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> dom = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">  dom.innerHTML = <span class="string">&#x27;item&#x27;</span>;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(dom);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于我们需要处理<code>CSS</code>文件，所以我们需要保留处理<code>CSS</code>文件的<code>loader</code>规则，像下面这样</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 其它配置</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [<span class="string">&#x27;style-loader&#x27;</span>, <span class="string">&#x27;css-loader&#x27;</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在以上代码添加和配置完毕后，我们使用<code>npm run dev</code>进行打包，我们点击按钮后，它会出现如下的情况</p>
<p><strong>理解</strong>： 由于<code>item</code>是动态生成的，当我们要将<code>yellow</code>颜色改变成<code>red</code>时，模块热更新能帮我们在不刷新浏览器的情况下，替换掉样式的内容。直白来说：自动生成的<code>item</code>依然存在，只是颜色变了。</p>
<h4 id="在js中的模块热更新"><a href="#在js中的模块热更新" class="headerlink" title="在js中的模块热更新"></a>在js中的模块热更新</h4><p>在介绍完<code>CSS</code>中的模块热更新后，我们接下来介绍在<code>js</code>中的模块热更新。<br></p>
<p>首先，我们在<code>src</code>目录下创建两个<code>.js</code>文件，分别叫<code>counter.js</code>和<code>number.js</code>，它的代码可以写成下面这样：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// counter.js代码</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> dom = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">  dom.setAttribute(<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;counter&#x27;</span>);</span><br><span class="line">  dom.innerHTML = <span class="number">1</span>;</span><br><span class="line">  dom.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    dom.innerHTML = <span class="built_in">parseInt</span>(dom.innerHTML,<span class="number">10</span>)+<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(dom);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>number.js</code>中的代码是下面这样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// number.js代码</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">number</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> dom = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">  dom.setAttribute(<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;number&#x27;</span>);</span><br><span class="line">  dom.innerHTML = <span class="string">&#x27;1000&#x27;</span>;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(dom);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>添加完以上两个<code>.js</code>文件后，我们再来对<code>index.js</code>文件做一下小小的改动：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js代码</span></span><br><span class="line"><span class="keyword">import</span> counter <span class="keyword">from</span> <span class="string">&#x27;./counter&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> number <span class="keyword">from</span> <span class="string">&#x27;./number&#x27;</span>;</span><br><span class="line">counter();</span><br><span class="line">number();</span><br></pre></td></tr></table></figure>
<p>在以上都改动完毕后，我们使用<code>npm run dev</code>进行打包，在页面上点击数字<code>1</code>，让它不断的累计到你喜欢的一个数值(记住这个数值)，这个时候我们再去修改<code>number.js</code>中的代码，将<code>1000</code>修改为<code>3000</code>，也就是下面这样修改：</p>
<figure class="highlight js"><figcaption><span>&#123;5&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// number.js代码</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">number</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> dom = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">  dom.setAttribute(<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;number&#x27;</span>);</span><br><span class="line">  dom.innerHTML = <span class="string">&#x27;3000&#x27;</span>;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(dom);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们发现，虽然<code>1000</code>成功变成了<code>3000</code>，但我们累计的数值却重置到了<code>1</code>，这个时候你可能会问，我们不是配置了模块热更新了吗，为什么不像<code>CSS</code>一样，直接替换即可？</p>
<p><strong>回答</strong>：这是因为<code>CSS</code>文件，我们是使用了<code>loader</code>来进行处理，有些<code>loader</code>已经帮我们写好了模块热更新的代码，我们直接使用即可(类似的还有<code>.vue</code>文件，<code>vue-loader</code>也帮我们处理好了模块热更新)。而对于<code>js</code>代码，还需要我们写一点点额外的代码，像下面这样子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> counter <span class="keyword">from</span> <span class="string">&#x27;./counter&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> number <span class="keyword">from</span> <span class="string">&#x27;./number&#x27;</span>;</span><br><span class="line">counter();</span><br><span class="line">number();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 额外的模块HMR配置</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">  <span class="built_in">module</span>.hot.accept(<span class="string">&#x27;./number.js&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.body.removeChild(<span class="built_in">document</span>.getElementById(<span class="string">&#x27;number&#x27;</span>));</span><br><span class="line">    number();</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>写完上面的额外代码后，我们再在浏览器中重复我们刚才的操作，即：</p>
<ul>
<li>累加数字<code>1</code>带你喜欢的一个值</li>
<li>修改<code>number.js</code>中的<code>1000</code>为你喜欢的一个值</li>
</ul>
<p>以下截图是我的测试结果，同时我们也可以在控制台<code>console</code>上，看到模块热更新第二次启动时，已经成功帮我们把<code>number.js</code>中的代码输出到了浏览器。</p>
<p><strong>小结</strong>：在更改<code>CSS</code>样式文件时，我们不用书写<code>module.hot</code>，这是因为各种<code>CSS</code>的<code>loader</code>已经帮我们处理了，相同的道理还有<code>.vue</code>文件的<code>vue-loader</code>，它也帮我们处理了模块热更新，但在<code>.js</code>文件中，我们还是需要根据实际的业务来书写一点<code>module.hot</code>代码的。</p>
<h2 id="处理ES6语法"><a href="#处理ES6语法" class="headerlink" title="处理ES6语法"></a>处理ES6语法</h2><p>::: tip 说明<br>我们在项目中书写的<code>ES6</code>代码，由于考虑到低版本浏览器的兼容性问题，需要把<code>ES6</code>代码转换成低版本浏览器能够识别的<code>ES5</code>代码。使用<code>babel-loader</code>和<code>@babel/core</code>来进行<code>ES6</code>和<code>ES5</code>之间的链接，使用<code>@babel/preset-env</code>来进行<code>ES6</code>转<code>ES5</code><br>:::<br>在处理<code>ES6</code>代码之前，我们先来清理一下前面小节的中的代理，我们需要删除<code>counter.js</code>、<code>number.js</code>和<code>style.css</code>这个三个文件，删除后的文件目录大概是下面这样子的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">|-- dist</span><br><span class="line">|   |-- index.html</span><br><span class="line">|   |-- main.js</span><br><span class="line">|-- src</span><br><span class="line">|   |-- index.html</span><br><span class="line">|   |-- index.js</span><br><span class="line">|-- package.json</span><br><span class="line">|-- webpack.config.js</span><br></pre></td></tr></table></figure>
<p>要处理<code>ES6</code>代码，需要我们安装几个<code>npm</code>包，可以使用如下的命令去安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 babel-loader @babel/core</span></span><br><span class="line">$ npm install babel-loader @babel/core --save-dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 @babel/preset-env</span></span><br><span class="line">$ npm install @babel/preset-env --save-dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 @babel/polyfill进行ES5代码补丁</span></span><br><span class="line">$ npm install @babel/polyfill --save-dev</span><br></pre></td></tr></table></figure>
<p>安装完毕后，我们需要改写<code>src/index.js</code>中的代码，可以是下面这个样子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@babel/polyfill&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> arr = [</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">() =&gt;</span> &#123;&#125;),</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">() =&gt;</span> &#123;&#125;),</span><br><span class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">() =&gt;</span> &#123;&#125;)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">arr.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>处理<code>ES6</code>代码，需要我们使用<code>loader</code>，所以需要在<code>webpack.config.js</code>中添加如下的代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 其它配置</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        use: &#123;</span><br><span class="line">          loader: <span class="string">&#x27;babel-loader&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@babel/preset-env</code>需要在根目录下有一个<code>.babelrc</code>文件，所以我们新建一个<code>.babelrc</code>文件，它的代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;presets&quot;</span>: [<span class="string">&quot;@babel/preset-env&quot;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为了让我们的打包变得更加清晰，我们需要在<code>webpack.config.js</code>中把<code>source-map</code>配置成<code>none</code>，像下面这样：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 其他配置</span></span><br><span class="line">  mode: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">  devtool: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本次打包，我们需要使用<code>npx webpack</code>，打包的结果如下图所示：</p>
<p>在以上的打包中，我们可以发现：</p>
<ul>
<li>箭头函数被转成了普通的函数形式</li>
<li>如果你仔细观察这次打包输出的话，你会发现打包体积会非常大，有几百K，这是因为我们将<code>@babel/polyfill</code>中的代码全部都打包进了我们的代码中</li>
</ul>
<p>针对以上最后一个问题，我们希望，我们使用了哪些<code>ES6</code>代码，就引入它对应的<code>polyfill</code>包，达到一种按需引入的目的，要实现这样一个效果，我们需要在<code>.babelrc</code>文件中做一下小小的改动，像下面这样：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;presets&quot;</span>: [[<span class="string">&quot;@babel/preset-env&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">&quot;corejs&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">&quot;useBuiltIns&quot;</span>: <span class="string">&quot;usage&quot;</span></span><br><span class="line">  &#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同时需要注意的时，我们使用了<code>useBuiltIns:&quot;usage&quot;</code>后，在<code>index.js</code>中就不用使用<code>import &#39;@babel/polyfill&#39;</code>这样的写法了，因为它已经帮我们自动这样做了。<br></p>
<p>在以上配置完毕后，我们再次使用<code>npx webpack</code>进行打包，如下图，可以看到此次打包后，<code>main.js</code>的大小明显变小了。</p>

  </div>
  <div>
    <a href="https://github.com/Mcguffen/mcguffen.github.io/edit/myblog/source/_posts/docs/webpack/core.md"target="_blank">编辑</a>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/Mcguffen?tab=repositories">项目</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Webpack%E6%A0%B8%E5%BF%83"><span class="toc-number">1.</span> <span class="toc-text">Webpack核心</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8WebpackPlugin"><span class="toc-number">1.1.</span> <span class="toc-text">使用WebpackPlugin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#html-webpack-plugin"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">html-webpack-plugin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#clean-webpack-plugin"><span class="toc-number">1.1.0.2.</span> <span class="toc-text">clean-webpack-plugin</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Entry%E5%92%8COutput%E7%9A%84%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">Entry和Output的基础配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.1.</span> <span class="toc-text">多个入口文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CDN%E5%BC%95%E7%94%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text">CDN引用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AESourceMap"><span class="toc-number">1.3.</span> <span class="toc-text">配置SourceMap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8WebpackDevServer"><span class="toc-number">1.4.</span> <span class="toc-text">使用WebpackDevServer</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#watch%E5%8F%82%E6%95%B0%E8%87%AA%E5%8A%A8%E6%89%93%E5%8C%85"><span class="toc-number">1.4.0.1.</span> <span class="toc-text">watch参数自动打包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webpack-dev-server%E6%89%93%E5%8C%85"><span class="toc-number">1.4.0.2.</span> <span class="toc-text">webpack-dev-server打包</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%B4%E6%96%B0-HMR"><span class="toc-number">1.5.</span> <span class="toc-text">模块热更新(HMR)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CSS%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%B4%E6%96%B0"><span class="toc-number">1.5.0.1.</span> <span class="toc-text">CSS中的模块热更新</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8js%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%B4%E6%96%B0"><span class="toc-number">1.5.0.2.</span> <span class="toc-text">在js中的模块热更新</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86ES6%E8%AF%AD%E6%B3%95"><span class="toc-number">1.6.</span> <span class="toc-text">处理ES6语法</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://mcguffen.github/2020/11/20/docs/webpack/core/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&text=Webpack核心"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&is_video=false&description=Webpack核心"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Webpack核心&body=Check out this article: https://mcguffen.github/2020/11/20/docs/webpack/core/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&title=Webpack核心"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://mcguffen.github/2020/11/20/docs/webpack/core/&name=Webpack核心&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://mcguffen.github/2020/11/20/docs/webpack/core/&t=Webpack核心"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2021
    Hi! I am yang.
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/Mcguffen?tab=repositories">项目</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
